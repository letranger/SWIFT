#+TITLE: SwiftUI
#+INCLUDE: ../web.org

#+latex:\newpage

* iOS app çš„é–‹ç™¼ç•Œé¢: UIKit v.s. SwiftUI
** UIKit èˆ‡ SwiftUI çš„å·®ç•°æ€§
*** ç³»çµ±éœ€æ±‚
UIKit æ˜¯å¾ Xcode1 å°±ä¸€ç›´å­˜åœ¨çš„ Frameworkï¼›è€Œ SwiftUI å‰‡æ˜¯ 2019/6 WWDC æ‰€ç™¼è¡¨çš„å…¨æ–°ç”¨ä¾†ç¹ªè£½ UI çš„ Frameworkã€‚å› æ­¤ï¼ŒSwiftUI å¿…é ˆæ­é… iOS13+ å’Œ MacOS10.15+ã€‚[fn:1]
*** åº•å±¤èªè¨€
UIKit åº•å±¤ä»ç‚º Objecitve-Cï¼›è€Œ SwiftUI å‰‡æ˜¯å®Œå®Œå…¨å…¨ç”¨ Swift æ‰“é€ çš„ Frameworkã€‚
*** èªæ³•ç°¡æ½”åº¦
SwiftUI ç”¢ç”Ÿä¸€é¡¯ç¤ºæ–‡å­—çš„å…ƒä»¶æ›´ç²¾ç°¡æ½”äº†ã€‚
*** è·¨å¹³å°
è·¨å¹³å°æŒ‡çš„éè·¨ Android(ä½†å¸Œæœ›æœ‰é‚£éº¼ä¸€å¤©æ˜¯å¯ä»¥æ”¯æ´çš„ğŸ˜€)ã€‚è·¨å¹³å°æŒ‡çš„æ˜¯ä½¿ç”¨ SwiftUI æ‰€é–‹ç™¼çš„å°ˆæ¡ˆï¼Œå¯ä»¥åŒæ™‚æ”¯æ´ macOSã€watchOSã€tvOS ç­‰ç³»çµ±ã€‚å¼•ç”¨ä¸€å¥ WWDC2019 SwiftUI æ¼”è¬›è€…æ‰€èªªçš„ä¸€å¥è©±ã€‚
#+BEGIN_QUOTE
Learn once, apply everywhere.
#+END_QUOTE
*** Automatic Preview
é€™æ˜¯æ­¤æ¬¡ SwiftUI æœ€å¤§çš„äº®é»ä¹‹ä¸€ï¼Œæ‰€è¬‚ Automatic Previewï¼Œæ„æ€æŒ‡çš„æ˜¯å³æ™‚é è¦½ï¼Œå³æˆ‘å€‘ä¸€é‚Šèª¿æ•´ç¨‹å¼ç¢¼çš„åŒæ™‚ï¼Œä¹Ÿå¯ä»¥ç«‹å³çœ‹åˆ°ä¿®æ”¹å¾Œçš„çµæœã€‚
*** è‡ªå‹•æ”¯æ´é€²éšåŠŸèƒ½
SwiftUI æœ¬èº«å³æ”¯æ´ Dynamic Typeã€Dark Modeã€ Localization ç­‰ç­‰ã€‚é€™é‚Šç‰¹åˆ¥ä¾†è¬›ä¸€ä¸‹ UIKit å’Œ SwiftUI åœ¨æ–‡å­—è¨­å®šä¸Šæœ‰é—œæ–¼ Dark Mode çš„å·®ç•°ï¼ŒUIKit è‹¥æ˜¯ç„¡ç‰¹åˆ¥æŒ‡å®šæ–‡å­—çš„é¡è‰²(æ„å³ä½¿ç”¨ Default çš„é¸é …)ï¼Œåœ¨ Light Mode å­—é«”æœƒæ˜¯ç™½è‰²ï¼›ç›¸å°çš„åœ¨ Dark Mode å³æœƒæ˜¯ç™½è‰²ï¼Œé€™é»è·Ÿ SwiftUI æ²’æœ‰ç‰¹åˆ¥çš„å·®ç•°ï¼Œä½†æ˜¯ SwiftUI é™¤äº† Default å¤–ï¼Œé‚„æœ‰ Secondaryï¼Œå¦‚æœé‚„ä¸å–œæ­¡çš„è©±ï¼Œé‚„æœ‰ç¬¬ä¸‰å€‹é¸é …ï¼Œå°±æ˜¯åœ¨ Assets è‡ªè¡Œè¨­å®š Light Mode å’Œ Dark Mode åˆ†åˆ¥è¦é¡¯ç¤ºçš„é¡è‰²ğŸ˜€
#+CAPTION: UIKit èˆ‡ SwiftUI çš„å·®ç•°æ€§æ¯”è¼ƒåœ–
#+LABEL:fig:Diff-1
#+name: fig:Diff-1
#+ATTR_LATEX: :width 400
#+ATTR_ORG: :width 400
[[file:images/differences.png]]

** SwiftUI vs UIKit: Benefits and Drawbacks
*** Drawbacks of SwiftUI [fn:2]
- It supports only iOS 13 and Xcode 11. By switching to them, you abandon users of older versions of iOS, which is a radical move devoid of concern for the user. But since Apple annually updates its list of supported iOS versions, I think SwiftUI will be used more over the next two years as users install the latest iOS version.
- Itâ€™s still very young, so there isnâ€™t much data on Stack Overflow. This means that you canâ€™t get much help resolving complicated issues.
- It doesnâ€™t allow you to examine the view hierarchy in Xcode Previews.
*** Benefits of SwiftUI [fn:2]
- Itâ€™s easy to learn, and the code is simple and clean.
- It can be mixed with UIKit using UIHostingController.
- It allows you to easily manage themes. Developers can easily add dark mode to their apps and set it as the default theme, and users can easily enable dark mode. Besides, it looks awesome.
- SwiftUI provides mechanisms for reactive programming enthusiasts with BindableObject, ObjectBinding, and the whole Combine framework.
- It offers Live Preview. This is a very convenient and progressive way to see the results of code execution in real time without having to build. Iâ€™m not sure if it somehow affects the processor. So far, Iâ€™ve noticed a delay provoked by the use of Live Preview, but I think Apple will soon make improvements.
- SwiftUI no longer needs Interface Builder. It was replaced by Canvas, an interactive interface editor. When writing code, the visual part in Canvas is automatically generated, and when you create visual presentation elements, they automatically appear in the code.
- Your application will no longer crash if you forget to update the @IBOutlet association with the variable.
- Thereâ€™s no AutoLayout or related problems. Instead, you use things like HStack, VStack, ZStack, Groups, Lists, and more. Unlike AutoLayout, SwiftUI always produces a valid layout. Thereâ€™s no such thing as an ambiguous or unsatisfiable layout. SwiftUI replaces storyboards with code, making it easy to create a reusable view and avoid conflicts related with the simultaneous use of one project by the development team.

* AppDelegate v.s. SceneDelegate
- SceneDelegate ç‚º Xcode11 æ‰€å¸¶ä¾†çš„è®ŠåŒ–(å¯åƒè€ƒå®˜æ–¹æ–‡ä»¶ WWDC2019)ï¼Œæ”¾åœ¨ SwiftUI æä¼¼ä¹ä¸å¤ªåˆé©ï¼Œä½†æ˜¯åœ¨æ¥ä¸‹ä¾†åœ¨æåˆ° SwiftUI App çš„ç”Ÿå‘½é€±æœŸæ™‚æœƒå¸¶åˆ°ï¼Œæ‰€ä»¥é€™é‚Šå°±å¤§æ¦‚æä¸€ä¸‹ã€‚
- AppDelegate åŸä¾†çš„è·è²¬ç‚ºè² è²¬ App çš„ç”Ÿå‘½é€±æœŸå’Œ UI ç”Ÿå‘½é€±æœŸï¼Œåœ¨ Xcode11 å¾Œï¼ŒAppDelegate å°‡ UI çš„ç”Ÿå‘½é€±æœŸ(Scene Session)äº¤çµ¦ SceneDelegateã€‚åŸ Xcode10
- ä½¿ç”¨ Swift ç‚º User Interface çš„å°ˆæ¡ˆ Launch çš„ç”Ÿå‘½é€±æœŸç‚º AppDelegate â†’ ViewControllerï¼Œè€Œä½¿ç”¨ SwiftUI ç‚º User Interface çš„å°ˆæ¡ˆå‰‡è®Šæˆç‚º AppDelegate â†’ SceneDelegate â†’ ContentViewï¼ŒåŸæœ¬æ‡‰è©²å‡ºç¾åœ¨ AppDelegate çš„ applicationWillEnterForeground(_:) ç­‰ç›¸é—œ App åˆ°å‰ã€èƒŒæ™¯ç­‰ç›¸é—œçš„ç”Ÿå‘½é€±æœŸé‚è¼¯ä¹Ÿéƒ½ç§»è‡³ SceneDelegate è£¡äº†ï¼Œmethod åç¨± application çš„å‰ç¶´å­—ä¹Ÿéƒ½æ›´æ”¹ç‚º scene äº†ã€‚[fn:3]
** SceneDelegate.swift
#+begin_src swift -r -n :results output :exports both
import UIKit
import SwiftUI

class SceneDelegate: UIResponder, UIWindowSceneDelegate {

    var window: UIWindow?


    func scene(_ scene: UIScene, willConnectTo session: UISceneSession, options connectionOptions: UIScene.ConnectionOptions) {
        // Use this method to optionally configure and attach the UIWindow `window` to the provided UIWindowScene `scene`.
        // If using a storyboard, the `window` property will automatically be initialized and attached to the scene.
        // This delegate does not imply the connecting scene or session are new (see `application:configurationForConnectingSceneSession` instead).

        // Create the SwiftUI view that provides the window contents.
        let contentView = ContentView()

        // Use a UIHostingController as window root view controller.
        if let windowScene = scene as? UIWindowScene {
            let window = UIWindow(windowScene: windowScene)
            window.rootViewController = UIHostingController(rootView: contentView)
            self.window = window
            window.makeKeyAndVisible()
        }
    }

    func sceneDidDisconnect(_ scene: UIScene) {
        // Called as the scene is being released by the system.
        // This occurs shortly after the scene enters the background, or when its session is discarded.
        // Release any resources associated with this scene that can be re-created the next time the scene connects.
        // The scene may re-connect later, as its session was not neccessarily discarded (see `application:didDiscardSceneSessions` instead).
    }

    func sceneDidBecomeActive(_ scene: UIScene) {
        // Called when the scene has moved from an inactive state to an active state.
        // Use this method to restart any tasks that were paused (or not yet started) when the scene was inactive.
    }

    func sceneWillResignActive(_ scene: UIScene) {
        // Called when the scene will move from an active state to an inactive state.
        // This may occur due to temporary interruptions (ex. an incoming phone call).
    }

    func sceneWillEnterForeground(_ scene: UIScene) {
        // Called as the scene transitions from the background to the foreground.
        // Use this method to undo the changes made on entering the background.
    }

    func sceneDidEnterBackground(_ scene: UIScene) {
        // Called as the scene transitions from the foreground to the background.
        // Use this method to save data, release shared resources, and store enough scene-specific state information
        // to restore the scene back to its current state.
    }


}


struct SceneDelegate_Previews: PreviewProvider {
    static var previews: some View {
        /*@START_MENU_TOKEN@*/Text("Hello, World!")/*@END_MENU_TOKEN@*/
    }
}
#+end_src
* UIKit

* SwiftUI
** ä½¿ç”¨ SwiftUI é–‹å•Ÿæ–°å°ˆæ¡ˆ [fn:3]
1) é¦–å…ˆï¼Œæ‰“é–‹ Xcodeï¼Œä¸¦é»æ“Š Create new Xcode projectã€‚åœ¨ iOS ä¹‹ä¸‹é¸æ“‡ Single View Appï¼Œä¸¦ç‚ºå°ˆæ¡ˆå‘½åã€‚
2) ç„¶å¾Œåœ¨ä¸‹æ–¹å‹¾é¸ Use SwiftUI çš„é¸é …ï¼Œå¦‚æœæ²’æœ‰å‹¾é¸è©²é¸é …çš„è©±ï¼ŒXcode æœƒè‡ªå‹•ç”¢ç”Ÿ storyboard æª”æ¡ˆ(UIKit)ã€‚
3) Xcode æœƒè‡ªå‹•å¹«ä½ å‰µå»ºä¸€å€‹åç‚º ContentView.swif çš„æª”æ¡ˆï¼ŒXcode æœƒåœ¨ç¨‹å¼ç¢¼çš„å³é‚Šå‘ˆç¾ä¸€å€‹å³æ™‚çš„é è¦½è¦–çª—(preview), é»é¸ resume éˆ•ç”Ÿæˆé è¦½ç•«é¢(æœƒèŠ±ä¸€é»æ™‚é–“)ã€‚
*** ContentView.swift
#+begin_src swift -r -n :results output :exports both
import SwiftUI

struct ContentView: View {
    var body: some View {
        Text("æ–‡å­—")
    }
}

struct ContentView_Previews: PreviewProvider {
    static var previews: some View {
        ContentView()
    }
}
#+end_src

** Text
*** æ”¹è®Š Text çš„å±¬æ€§
**** UI:
1) on Text object (in preview screen): CMD + click
2) select *Show SwiftUI Inspector*
3) change *Text*, *Font*, *Color*
4) Monitor the corresponding code changes in code window
**** code
***** CMD + click
***** directly insert code
*** Attributes
- frame
- foregroundColor
- background
- font
  
** VStack
#+begin_src swift -r -n :results output :exports both
import SwiftUI

struct ContentView: View {
    var body: some View {
        VStack {
            Text("ç¬¬ä¸€è¡Œæ–‡å­—")
            Text("ç¬¬äºŒè¡Œæ–‡å­—")
        }
    }
}

struct ContentView_Previews: PreviewProvider {
    static var previews: some View {
        ContentView()
    }
}
#+end_src
#+CAPTION: VStack
#+LABEL:fig:VStack-1
#+name: fig:VStack-1
#+ATTR_LATEX: :width 300
#+ATTR_ORG: :width 300
[[file:images/vstack-1.jpg]]

** HStack
#+begin_src swift -r -n :results output :exports both
import SwiftUI

struct ContentView: View {
    var body: some View {
        HStack {
            VStack {
                Button("è«‹æŒ‰æˆ‘") {
                    print("TEST")
                }
                .frame(width: 60, height: 30, alignment: .center)
                .foregroundColor(.white)
                .background(Color.green)
                Button("åˆ¥äº‚æŒ‰") {
                    print("QQ")
                }
            }
            VStack {
                Text("ç¬¬ä¸€è¡Œæ–‡å­—")
                    .frame(width: 100, height: 30, alignment: .center   )
                    .foregroundColor(.white)
                    .background(Color.orange)
                Text("ç¬¬äºŒè¡Œæ–‡å­—")
                    .frame(width: 100, height: 30, alignment: .center)
                    .foregroundColor(.white)
                    .background(Color.red)
            }
        }
    }
}

struct ContentView_Previews: PreviewProvider {
    static var previews: some View {
        ContentView()
    }
}
#+end_src
#+CAPTION: HStack
#+LABEL:fig:HStack-1
#+name: fig:HStack-1
#+ATTR_LATEX: :width 300
#+ATTR_ORG: :width 300
[[file:images/hstack-1.jpg]]
** Image
*** System Image
- [[https://developer.apple.com/design/human-interface-guidelines/sf-symbols/overview/][SF Symbols ]][fn:4]
  å¾ iOS 13 é–‹å§‹ï¼ŒApple ä»‹ç´¹äº†ä¸€å€‹åç‚º SFSymbols çš„æ–°åŠŸèƒ½ã€‚SF Symbols é€™åŠŸèƒ½ç”± Apple æ‰€è¨­è¨ˆï¼Œç•¶ä¸­é›†åˆäº† 1500 å¤šå€‹å¯ä»¥åœ¨ App ä¹‹ä¸­ä½¿ç”¨çš„ç¬¦è™Ÿã€‚[fn:3]
- [[https://developer.apple.com/design/resources/][Download SF Symbols app]]
- code
#+begin_src swift -r -n :results output :exports both
Image(systemName: "icloud")
  .resizable()
  .scaledToFit()
  .frame(width: 100, height: 80, alignment: .center)

#+end_src

*** Customized Image
1) Drag image into Project folder *Assets.xcassets*
2) Add following code
#+begin_src swift -r -n :results output :exports both
Image("ImageName")
  .resizable()
  .scaledToFit()
  .frame(width: 200, height: 160, alignment: .center)
#+end_src

** Button
*** èªæ³•
#+begin_src swift -r -n :results output :exports both
//...
Button("Title") {
    //action
}

Button(action: <#T##() -> Void#>, label: <#T##() -> _#>)
//...
#+end_src
*** ç¯„ä¾‹: æŒ‰ä¸‹ Buttonï¼Œæ”¹è®Š Text title
#+begin_src swift -r -n :results output :exports both
struct ContentView: View {
    @State private var title = "Hello SWiftUI"

    var body: some View {
        VStack {
            Text(verbatim: title)
                .padding(4)
                .foregroundColor(.white)
                .background(Color.gray)
            Button(action: {
                self.title = "Good Day"
            }) {
                Text("è«‹æŒ‰æˆ‘1")
                    .foregroundColor(.white)
                    .padding(4)
                    .background(Color.blue)
            }
            Button("è«‹æŒ‰æˆ‘2") {
                self.title = "Good night..."
            }
        }
    }
}
#+end_src
#+CAPTION: Button
#+LABEL:fig:Button-1
#+name: fig:Button-1
#+ATTR_LATEX: :width 300
#+ATTR_ORG: :width 300
[[file:images/swbtn-1.jpg]]
** TextField
*** èªæ³•
#+begin_src swift -r -n :results output :exports both
@State private var è®Šæ•¸="å€¼"
TextField("æç¤ºæ–‡å­—", text: $è®Šæ•¸)
#+end_src

*** ç¯„ä¾‹: æ–¼ TextField è¼¸å…¥è³‡æ–™ï¼Œé¡¯ç¤ºæ–¼ Text ä¸­
#+begin_src swift -r -n :results output :exports both
import SwiftUI

struct ContentView: View {
    @State private var title = ""

    var body: some View {
        VStack {
            Text(verbatim: "Hello "+title)
            HStack {
                Text("Your Name: ")
                TextField("è«‹è¼¸å…¥å§“å:", text: $title)
            }
        }
    }
}

struct ContentView_Previews: PreviewProvider {
    static var previews: some View {
        ContentView()
    }
}
#+end_src
#+CAPTION: Button
#+LABEL:fig:Button-1
#+name: fig:Button-1
#+ATTR_LATEX: :width 300
#+ATTR_ORG: :width 300
[[file:images/txtfield-1.jpg]]

* Customize UI Components




* Advanced Commponents
** List


* Footnotes

[fn:1] [[https://medium.com/@mikru168/swiftui-%E6%B7%BA%E7%8E%A9-swiftui-%E7%94%A8%E5%85%B6%E5%BB%BA%E6%A7%8B%E4%B8%80%E7%B0%A1%E5%96%AE%E7%9A%84-app-2f2477bd49d7][ç°¡ä»‹ SwiftUI & ç”¨å…¶å»ºæ§‹ä¸€ç°¡å–®çš„ APP ]]

[fn:2] [[https://medium.com/@SteelKiwiDev/swiftui-vs-uikit-benefits-and-drawbacks-6a540cced684][SwiftUI vs UIKit: Benefits and Drawbacks]]

[fn:3] [[https://www.appcoda.com.tw/swiftui-introduction/][SwiftUI åˆé«”é©—ï¼š å»ºæ§‹ä¸€å€‹ç°¡å–® Appã€€è®“ä½ äº†è§£ SwiftUI æœ‰å¤šå¼·å¤§ï¼]]

[fn:4] [[https://stackoverflow.com/questions/56514998/find-all-available-images-for-imagesystemname-in-swiftui][Find all available images for Image(systemName:) in SwiftUI]]
